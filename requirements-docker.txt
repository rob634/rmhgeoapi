# ============================================================================
# Docker Worker Dependencies
# ============================================================================
# Same as requirements.txt MINUS azure-functions, PLUS FastAPI/uvicorn.
#
# NOTE: GDAL is NOT listed here - it comes pre-installed in the base image
# (ghcr.io/osgeo/gdal:ubuntu-full-3.10.1). Do NOT add GDAL to this file.
#
# Updated: 19 FEB 2026 - CVE fixes, version pinning
# ============================================================================

# === Azure SDK ===
azure-storage-blob>=12.20.0
azure-storage-queue>=12.9.0
azure-data-tables>=12.5.0
azure-identity>=1.16.1
azure-keyvault-secrets>=4.8.0
azure-servicebus>=7.11.0
azure-mgmt-datafactory>=4.0.0
azure-monitor-opentelemetry>=1.6.0

# === Geospatial Core ===
geopandas>=1.1.2                      # CVE-2025-69662 (SQL injection) fixed in 1.1.2
psycopg[binary]>=3.1.0
rasterio>=1.3.1
rio-cogeo>=5.0.0
rio-stac>=0.10.0
cogeo-mosaic>=7.0.0

# === Schema Validation ===
pydantic>=2.0.0

# === NumPy: Pin to <2 for C-extension ABI compatibility ===
numpy<2

# === Profiling ===
psutil>=5.9.0

# === STAC Implementation ===
pypgstac==0.9.8
psycopg-pool>=3.1.0
pystac>=1.13.0
pystac-client>=0.7.0
stac-pydantic>=3.4.0

# === DuckDB ===
duckdb>=1.1.0
pyarrow>=14.0.1,<22.0

# === H3 ===
h3>=4.0.0

# === Raster / STAC Utilities ===
rasterstats>=0.19.0
planetary-computer>=1.0.0

# === Async PostgreSQL ===
asyncpg>=0.29.0

# === xarray ecosystem (Zarr direct access) ===
xarray>=2024.1.0
zarr>=2.16.0
fsspec>=2024.2.0
adlfs>=2024.2.0
aiohttp>=3.13.3                       # CVE-2025-69223 + 5 others fixed in 3.13.3

# === HTTP / Image ===
httpx>=0.27.0
pillow>=12.1.1                        # CVE-2026-25990 (OOB write) fixed in 12.1.1

# === Docker Worker HTTP Server ===
fastapi>=0.104.0
uvicorn>=0.24.0
jinja2>=3.1.6                         # CVE-2025-27516 (sandbox breakout) fixed in 3.1.6
